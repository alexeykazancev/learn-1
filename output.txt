alexey@alexey-desktop-22:~/otus/learn-1$ ../packer build  template.json 
yandex: output will be in this color.

==> yandex: Creating temporary RSA SSH key for instance...
==> yandex: Using as source image: fd89ka9p6idl8htbmhok (name: "ubuntu-20-04-lts-v20220124", family: "ubuntu-2004-lts")
==> yandex: Creating network...
==> yandex: Creating subnet in zone "ru-central1-a"...
==> yandex: Creating disk...
==> yandex: Creating instance...
==> yandex: Waiting for instance with id fhm8tn17nkp14u09repl to become active...
    yandex: Detected instance IP: 130.193.36.145
==> yandex: Using SSH communicator to connect: 130.193.36.145
==> yandex: Waiting for SSH to become available...
==> yandex: Connected to SSH!
==> yandex: Provisioning with shell script: /tmp/packer-shell944721567
    yandex: updating apt cache
==> yandex:
==> yandex: WARNING: apt does not have a stable CLI interface. Use with caution in scripts.
==> yandex:
    yandex: Hit:1 http://mirror.yandex.ru/ubuntu focal InRelease
    yandex: Get:2 http://mirror.yandex.ru/ubuntu focal-updates InRelease [114 kB]
    yandex: Get:3 http://security.ubuntu.com/ubuntu focal-security InRelease [114 kB]
    yandex: Get:4 http://mirror.yandex.ru/ubuntu focal-backports InRelease [108 kB]
    yandex: Get:5 http://mirror.yandex.ru/ubuntu focal-updates/main i386 Packages [592 kB]
    yandex: Get:6 http://mirror.yandex.ru/ubuntu focal-updates/main amd64 Packages [1,510 kB]
    yandex: Get:7 http://mirror.yandex.ru/ubuntu focal-updates/main amd64 c-n-f Metadata [14.7 kB]
    yandex: Get:8 http://mirror.yandex.ru/ubuntu focal-updates/universe i386 Packages [664 kB]
    yandex: Get:9 http://mirror.yandex.ru/ubuntu focal-updates/universe amd64 Packages [894 kB]
    yandex: Get:10 http://mirror.yandex.ru/ubuntu focal-updates/universe Translation-en [196 kB]
    yandex: Get:11 http://mirror.yandex.ru/ubuntu focal-updates/universe amd64 c-n-f Metadata [20.1 kB]
    yandex: Get:12 http://mirror.yandex.ru/ubuntu focal-backports/universe i386 Packages [11.5 kB]
    yandex: Get:13 http://mirror.yandex.ru/ubuntu focal-backports/universe amd64 Packages [20.8 kB]
    yandex: Get:14 http://mirror.yandex.ru/ubuntu focal-backports/universe Translation-en [14.3 kB]
    yandex: Get:15 http://mirror.yandex.ru/ubuntu focal-backports/universe amd64 c-n-f Metadata [692 B]
    yandex: Get:16 http://security.ubuntu.com/ubuntu focal-security/main i386 Packages [363 kB]
    yandex: Get:17 http://security.ubuntu.com/ubuntu focal-security/main amd64 Packages [1,178 kB]
    yandex: Get:18 http://security.ubuntu.com/ubuntu focal-security/main amd64 c-n-f Metadata [9,132 B]
    yandex: Get:19 http://security.ubuntu.com/ubuntu focal-security/universe i386 Packages [532 kB]
    yandex: Get:20 http://security.ubuntu.com/ubuntu focal-security/universe amd64 Packages [677 kB]
    yandex: Get:21 http://security.ubuntu.com/ubuntu focal-security/universe amd64 c-n-f Metadata [13.0 kB]
    yandex: Fetched 7,046 kB in 2s (2,872 kB/s)
    yandex: Reading package lists...
    yandex: Building dependency tree...
    yandex: Reading state information...
    yandex: 7 packages can be upgraded. Run 'apt list --upgradable' to see them.
==> yandex:
==> yandex: WARNING: apt does not have a stable CLI interface. Use with caution in scripts.
==> yandex:
    yandex: Reading package lists...
    yandex: Building dependency tree...
    yandex: Reading state information...
    yandex: nano is already the newest version (4.8-1ubuntu1).
    yandex: The following additional packages will be installed:
    yandex:   fontconfig-config fonts-dejavu-core git-man libcurl3-gnutls liberror-perl
    yandex:   libfontconfig1 libgd3 libgdbm-compat4 libjbig0 libjpeg-turbo8 libjpeg8
    yandex:   libnginx-mod-http-image-filter libnginx-mod-http-xslt-filter
    yandex:   libnginx-mod-mail libnginx-mod-stream libperl5.30 libtiff5 libwebp6 libxpm4
    yandex:   libxslt1.1 nginx-common nginx-core patch perl perl-modules-5.30
    yandex: Suggested packages:
    yandex:   git-daemon-run | git-daemon-sysvinit git-doc git-el git-email git-gui gitk
    yandex:   gitweb git-cvs git-mediawiki git-svn libgd-tools fcgiwrap nginx-doc ssl-cert
    yandex:   diffutils-doc perl-doc libterm-readline-gnu-perl
    yandex:   | libterm-readline-perl-perl make libb-debug-perl liblocale-codes-perl
    yandex: The following NEW packages will be installed:
    yandex:   fontconfig-config fonts-dejavu-core git git-man libcurl3-gnutls
    yandex:   liberror-perl libfontconfig1 libgd3 libgdbm-compat4 libjbig0 libjpeg-turbo8
    yandex:   libjpeg8 libnginx-mod-http-image-filter libnginx-mod-http-xslt-filter
    yandex:   libnginx-mod-mail libnginx-mod-stream libperl5.30 libtiff5 libwebp6 libxpm4
    yandex:   libxslt1.1 nginx nginx-common nginx-core patch perl perl-modules-5.30
    yandex: 0 upgraded, 27 newly installed, 0 to remove and 7 not upgraded.
    yandex: Need to get 15.3 MB of archives.
    yandex: After this operation, 93.9 MB of additional disk space will be used.
    yandex: Get:1 http://mirror.yandex.ru/ubuntu focal-updates/main amd64 perl-modules-5.30 all 5.30.0-9ubuntu0.2 [2,738 kB]
    yandex: Get:2 http://mirror.yandex.ru/ubuntu focal/main amd64 libgdbm-compat4 amd64 1.18.1-5 [6,244 B]
    yandex: Get:3 http://mirror.yandex.ru/ubuntu focal-updates/main amd64 libperl5.30 amd64 5.30.0-9ubuntu0.2 [3,952 kB]
    yandex: Get:4 http://mirror.yandex.ru/ubuntu focal-updates/main amd64 perl amd64 5.30.0-9ubuntu0.2 [224 kB]
    yandex: Get:5 http://mirror.yandex.ru/ubuntu focal/main amd64 fonts-dejavu-core all 2.37-1 [1,041 kB]
    yandex: Get:6 http://mirror.yandex.ru/ubuntu focal/main amd64 fontconfig-config all 2.13.1-2ubuntu3 [28.8 kB]
    yandex: Get:7 http://mirror.yandex.ru/ubuntu focal-updates/main amd64 libcurl3-gnutls amd64 7.68.0-1ubuntu2.7 [232 kB]
    yandex: Get:8 http://mirror.yandex.ru/ubuntu focal/main amd64 liberror-perl all 0.17029-1 [26.5 kB]
    yandex: Get:9 http://mirror.yandex.ru/ubuntu focal-updates/main amd64 git-man all 1:2.25.1-1ubuntu3.2 [884 kB]
    yandex: Get:10 http://mirror.yandex.ru/ubuntu focal-updates/main amd64 git amd64 1:2.25.1-1ubuntu3.2 [4,554 kB]
    yandex: Get:11 http://mirror.yandex.ru/ubuntu focal/main amd64 libfontconfig1 amd64 2.13.1-2ubuntu3 [114 kB]
    yandex: Get:12 http://mirror.yandex.ru/ubuntu focal-updates/main amd64 libjpeg-turbo8 amd64 2.0.3-0ubuntu1.20.04.1 [117 kB]
    yandex: Get:13 http://mirror.yandex.ru/ubuntu focal/main amd64 libjpeg8 amd64 8c-2ubuntu8 [2,194 B]
    yandex: Get:14 http://mirror.yandex.ru/ubuntu focal/main amd64 libjbig0 amd64 2.1-3.1build1 [26.7 kB]
    yandex: Get:15 http://mirror.yandex.ru/ubuntu focal-updates/main amd64 libwebp6 amd64 0.6.1-2ubuntu0.20.04.1 [185 kB]
    yandex: Get:16 http://mirror.yandex.ru/ubuntu focal-updates/main amd64 libtiff5 amd64 4.1.0+git191117-2ubuntu0.20.04.2 [162 kB]
    yandex: Get:17 http://mirror.yandex.ru/ubuntu focal/main amd64 libxpm4 amd64 1:3.5.12-1 [34.0 kB]
    yandex: Get:18 http://mirror.yandex.ru/ubuntu focal-updates/main amd64 libgd3 amd64 2.2.5-5.2ubuntu2.1 [118 kB]
    yandex: Get:19 http://mirror.yandex.ru/ubuntu focal-updates/main amd64 nginx-common all 1.18.0-0ubuntu1.2 [37.5 kB]
    yandex: Get:20 http://mirror.yandex.ru/ubuntu focal-updates/main amd64 libnginx-mod-http-image-filter amd64 1.18.0-0ubuntu1.2 [14.4 kB]
    yandex: Get:21 http://mirror.yandex.ru/ubuntu focal/main amd64 libxslt1.1 amd64 1.1.34-4 [152 kB]
    yandex: Get:22 http://mirror.yandex.ru/ubuntu focal-updates/main amd64 libnginx-mod-http-xslt-filter amd64 1.18.0-0ubuntu1.2 [12.7 kB]
    yandex: Get:23 http://mirror.yandex.ru/ubuntu focal-updates/main amd64 libnginx-mod-mail amd64 1.18.0-0ubuntu1.2 [42.5 kB]
    yandex: Get:24 http://mirror.yandex.ru/ubuntu focal-updates/main amd64 libnginx-mod-stream amd64 1.18.0-0ubuntu1.2 [67.3 kB]
    yandex: Get:25 http://mirror.yandex.ru/ubuntu focal-updates/main amd64 nginx-core amd64 1.18.0-0ubuntu1.2 [425 kB]
    yandex: Get:26 http://mirror.yandex.ru/ubuntu focal-updates/main amd64 nginx all 1.18.0-0ubuntu1.2 [3,620 B]
    yandex: Get:27 http://mirror.yandex.ru/ubuntu focal/main amd64 patch amd64 2.7.6-6 [105 kB]
==> yandex: debconf: unable to initialize frontend: Dialog
==> yandex: debconf: (Dialog frontend will not work on a dumb terminal, an emacs shell buffer, or without a controlling terminal.)
==> yandex: debconf: falling back to frontend: Readline
==> yandex: debconf: unable to initialize frontend: Readline
==> yandex: debconf: (Can't locate Term/ReadLine.pm in @INC (you may need to install the Term::ReadLine module) (@INC contains: /etc/perl /usr/local/lib/x86_64-linux-gnu/perl/5.30.0 /usr/local/share/perl/5.30.0 /usr/lib/x86_64-linux-gnu/perl5/5.30 /usr/share/perl5 /usr/lib/x86_64-linux-gnu/perl/5.30 /usr/share/perl/5.30 /usr/local/lib/site_perl /usr/lib/x86_64-linux-gnu/perl-base) at /usr/share/perl5/Debconf/FrontEnd/Readline.pm line 7, <> line 27.)
==> yandex: debconf: falling back to frontend: Teletype
==> yandex: dpkg-preconfigure: unable to re-open stdin:
    yandex: Fetched 15.3 MB in 0s (71.5 MB/s)
    yandex: Selecting previously unselected package perl-modules-5.30.
    yandex: (Reading database ... 65715 files and directories currently installed.)
    yandex: Preparing to unpack .../00-perl-modules-5.30_5.30.0-9ubuntu0.2_all.deb ...
    yandex: Unpacking perl-modules-5.30 (5.30.0-9ubuntu0.2) ...
    yandex: Selecting previously unselected package libgdbm-compat4:amd64.
    yandex: Preparing to unpack .../01-libgdbm-compat4_1.18.1-5_amd64.deb ...
    yandex: Unpacking libgdbm-compat4:amd64 (1.18.1-5) ...
    yandex: Selecting previously unselected package libperl5.30:amd64.
    yandex: Preparing to unpack .../02-libperl5.30_5.30.0-9ubuntu0.2_amd64.deb ...
    yandex: Unpacking libperl5.30:amd64 (5.30.0-9ubuntu0.2) ...
    yandex: Selecting previously unselected package perl.
    yandex: Preparing to unpack .../03-perl_5.30.0-9ubuntu0.2_amd64.deb ...
    yandex: Unpacking perl (5.30.0-9ubuntu0.2) ...
    yandex: Selecting previously unselected package fonts-dejavu-core.
    yandex: Preparing to unpack .../04-fonts-dejavu-core_2.37-1_all.deb ...
    yandex: Unpacking fonts-dejavu-core (2.37-1) ...
    yandex: Selecting previously unselected package fontconfig-config.
    yandex: Preparing to unpack .../05-fontconfig-config_2.13.1-2ubuntu3_all.deb ...
    yandex: Unpacking fontconfig-config (2.13.1-2ubuntu3) ...
    yandex: Selecting previously unselected package libcurl3-gnutls:amd64.
    yandex: Preparing to unpack .../06-libcurl3-gnutls_7.68.0-1ubuntu2.7_amd64.deb ...
    yandex: Unpacking libcurl3-gnutls:amd64 (7.68.0-1ubuntu2.7) ...
    yandex: Selecting previously unselected package liberror-perl.
    yandex: Preparing to unpack .../07-liberror-perl_0.17029-1_all.deb ...
    yandex: Unpacking liberror-perl (0.17029-1) ...
    yandex: Selecting previously unselected package git-man.
    yandex: Preparing to unpack .../08-git-man_1%3a2.25.1-1ubuntu3.2_all.deb ...
    yandex: Unpacking git-man (1:2.25.1-1ubuntu3.2) ...
    yandex: Selecting previously unselected package git.
    yandex: Preparing to unpack .../09-git_1%3a2.25.1-1ubuntu3.2_amd64.deb ...
    yandex: Unpacking git (1:2.25.1-1ubuntu3.2) ...
    yandex: Selecting previously unselected package libfontconfig1:amd64.
    yandex: Preparing to unpack .../10-libfontconfig1_2.13.1-2ubuntu3_amd64.deb ...
    yandex: Unpacking libfontconfig1:amd64 (2.13.1-2ubuntu3) ...
    yandex: Selecting previously unselected package libjpeg-turbo8:amd64.
    yandex: Preparing to unpack .../11-libjpeg-turbo8_2.0.3-0ubuntu1.20.04.1_amd64.deb ...
    yandex: Unpacking libjpeg-turbo8:amd64 (2.0.3-0ubuntu1.20.04.1) ...
    yandex: Selecting previously unselected package libjpeg8:amd64.
    yandex: Preparing to unpack .../12-libjpeg8_8c-2ubuntu8_amd64.deb ...
    yandex: Unpacking libjpeg8:amd64 (8c-2ubuntu8) ...
    yandex: Selecting previously unselected package libjbig0:amd64.
    yandex: Preparing to unpack .../13-libjbig0_2.1-3.1build1_amd64.deb ...
    yandex: Unpacking libjbig0:amd64 (2.1-3.1build1) ...
    yandex: Selecting previously unselected package libwebp6:amd64.
    yandex: Preparing to unpack .../14-libwebp6_0.6.1-2ubuntu0.20.04.1_amd64.deb ...
    yandex: Unpacking libwebp6:amd64 (0.6.1-2ubuntu0.20.04.1) ...
    yandex: Selecting previously unselected package libtiff5:amd64.
    yandex: Preparing to unpack .../15-libtiff5_4.1.0+git191117-2ubuntu0.20.04.2_amd64.deb ...
    yandex: Unpacking libtiff5:amd64 (4.1.0+git191117-2ubuntu0.20.04.2) ...
    yandex: Selecting previously unselected package libxpm4:amd64.
    yandex: Preparing to unpack .../16-libxpm4_1%3a3.5.12-1_amd64.deb ...
    yandex: Unpacking libxpm4:amd64 (1:3.5.12-1) ...
    yandex: Selecting previously unselected package libgd3:amd64.
    yandex: Preparing to unpack .../17-libgd3_2.2.5-5.2ubuntu2.1_amd64.deb ...
    yandex: Unpacking libgd3:amd64 (2.2.5-5.2ubuntu2.1) ...
    yandex: Selecting previously unselected package nginx-common.
    yandex: Preparing to unpack .../18-nginx-common_1.18.0-0ubuntu1.2_all.deb ...
    yandex: Unpacking nginx-common (1.18.0-0ubuntu1.2) ...
    yandex: Selecting previously unselected package libnginx-mod-http-image-filter.
    yandex: Preparing to unpack .../19-libnginx-mod-http-image-filter_1.18.0-0ubuntu1.2_amd64.deb ...
    yandex: Unpacking libnginx-mod-http-image-filter (1.18.0-0ubuntu1.2) ...
    yandex: Selecting previously unselected package libxslt1.1:amd64.
    yandex: Preparing to unpack .../20-libxslt1.1_1.1.34-4_amd64.deb ...
    yandex: Unpacking libxslt1.1:amd64 (1.1.34-4) ...
    yandex: Selecting previously unselected package libnginx-mod-http-xslt-filter.
    yandex: Preparing to unpack .../21-libnginx-mod-http-xslt-filter_1.18.0-0ubuntu1.2_amd64.deb ...
    yandex: Unpacking libnginx-mod-http-xslt-filter (1.18.0-0ubuntu1.2) ...
    yandex: Selecting previously unselected package libnginx-mod-mail.
    yandex: Preparing to unpack .../22-libnginx-mod-mail_1.18.0-0ubuntu1.2_amd64.deb ...
    yandex: Unpacking libnginx-mod-mail (1.18.0-0ubuntu1.2) ...
    yandex: Selecting previously unselected package libnginx-mod-stream.
    yandex: Preparing to unpack .../23-libnginx-mod-stream_1.18.0-0ubuntu1.2_amd64.deb ...
    yandex: Unpacking libnginx-mod-stream (1.18.0-0ubuntu1.2) ...
    yandex: Selecting previously unselected package nginx-core.
    yandex: Preparing to unpack .../24-nginx-core_1.18.0-0ubuntu1.2_amd64.deb ...
    yandex: Unpacking nginx-core (1.18.0-0ubuntu1.2) ...
    yandex: Selecting previously unselected package nginx.
    yandex: Preparing to unpack .../25-nginx_1.18.0-0ubuntu1.2_all.deb ...
    yandex: Unpacking nginx (1.18.0-0ubuntu1.2) ...
    yandex: Selecting previously unselected package patch.
    yandex: Preparing to unpack .../26-patch_2.7.6-6_amd64.deb ...
    yandex: Unpacking patch (2.7.6-6) ...
    yandex: Setting up perl-modules-5.30 (5.30.0-9ubuntu0.2) ...
    yandex: Setting up libxpm4:amd64 (1:3.5.12-1) ...
    yandex: Setting up nginx-common (1.18.0-0ubuntu1.2) ...
    yandex: debconf: unable to initialize frontend: Dialog
    yandex: debconf: (Dialog frontend will not work on a dumb terminal, an emacs shell buffer, or without a controlling terminal.)
    yandex: debconf: falling back to frontend: Readline
    yandex: Created symlink /etc/systemd/system/multi-user.target.wants/nginx.service â†’ /lib/systemd/system/nginx.service.
    yandex: Setting up libcurl3-gnutls:amd64 (7.68.0-1ubuntu2.7) ...
    yandex: Setting up libjbig0:amd64 (2.1-3.1build1) ...
    yandex: Setting up patch (2.7.6-6) ...
    yandex: Setting up libwebp6:amd64 (0.6.1-2ubuntu0.20.04.1) ...
    yandex: Setting up fonts-dejavu-core (2.37-1) ...
    yandex: Setting up libgdbm-compat4:amd64 (1.18.1-5) ...
    yandex: Setting up libjpeg-turbo8:amd64 (2.0.3-0ubuntu1.20.04.1) ...
    yandex: Setting up libxslt1.1:amd64 (1.1.34-4) ...
    yandex: Setting up libperl5.30:amd64 (5.30.0-9ubuntu0.2) ...
    yandex: Setting up git-man (1:2.25.1-1ubuntu3.2) ...
    yandex: Setting up libjpeg8:amd64 (8c-2ubuntu8) ...
    yandex: Setting up libnginx-mod-mail (1.18.0-0ubuntu1.2) ...
    yandex: Setting up fontconfig-config (2.13.1-2ubuntu3) ...
    yandex: Setting up libnginx-mod-stream (1.18.0-0ubuntu1.2) ...
    yandex: Setting up libnginx-mod-http-xslt-filter (1.18.0-0ubuntu1.2) ...
    yandex: Setting up perl (5.30.0-9ubuntu0.2) ...
    yandex: Setting up libtiff5:amd64 (4.1.0+git191117-2ubuntu0.20.04.2) ...
    yandex: Setting up libfontconfig1:amd64 (2.13.1-2ubuntu3) ...
    yandex: Setting up liberror-perl (0.17029-1) ...
    yandex: Setting up libgd3:amd64 (2.2.5-5.2ubuntu2.1) ...
    yandex: Setting up git (1:2.25.1-1ubuntu3.2) ...
    yandex: Setting up libnginx-mod-http-image-filter (1.18.0-0ubuntu1.2) ...
    yandex: Setting up nginx-core (1.18.0-0ubuntu1.2) ...
    yandex: Setting up nginx (1.18.0-0ubuntu1.2) ...
    yandex: Processing triggers for ufw (0.36-6ubuntu1) ...
    yandex: Processing triggers for systemd (245.4-4ubuntu3.15) ...
    yandex: Processing triggers for man-db (2.9.1-1) ...
    yandex: Processing triggers for libc-bin (2.31-0ubuntu9.2) ...
==> yandex: Synchronizing state of nginx.service with SysV service script with /lib/systemd/systemd-sysv-install.
==> yandex: Executing: /lib/systemd/systemd-sysv-install enable nginx
==> yandex:   % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
==> yandex:                                  Dload  Upload   Total   Spent    Left  Speed
    yandex: <!DOCTYPE html>
    yandex: <html>
==> yandex: 100   612  100   612    0     0   597k      0 --:--:-- --:--:-- --:--:--  597k
    yandex: <head>
    yandex: <title>Welcome to nginx!</title>
    yandex: <style>
    yandex:     body {
    yandex:         width: 35em;
    yandex:         margin: 0 auto;
    yandex:         font-family: Tahoma, Verdana, Arial, sans-serif;
    yandex:     }
    yandex: </style>
    yandex: </head>
    yandex: <body>
    yandex: <h1>Welcome to nginx!</h1>
    yandex: <p>If you see this page, the nginx web server is successfully installed and
    yandex: working. Further configuration is required.</p>
    yandex:
    yandex: <p>For online documentation and support please refer to
    yandex: <a href="http://nginx.org/">nginx.org</a>.<br/>
    yandex: Commercial support is available at
    yandex: <a href="http://nginx.com/">nginx.com</a>.</p>
    yandex:
    yandex: <p><em>Thank you for using nginx.</em></p>
    yandex: </body>
    yandex: </html>
==> yandex: Stopping instance...
==> yandex: Deleting instance...
    yandex: Instance has been deleted!
==> yandex: Creating image: ubuntu-2004-lts-nginx-2022-01-28t11-26-05z
==> yandex: Waiting for image to complete...
==> yandex: Success image create...
==> yandex: Destroying subnet...
    yandex: Subnet has been deleted!
==> yandex: Destroying network...
    yandex: Network has been deleted!
==> yandex: Destroying boot disk...
    yandex: Disk has been deleted!
Build 'yandex' finished after 2 minutes 54 seconds.

==> Wait completed after 2 minutes 54 seconds

==> Builds finished. The artifacts of successful builds are:
--> yandex: A disk image was created: ubuntu-2004-lts-nginx-2022-01-28t11-26-05z (id: fd85ukjs5s3tgv3sg3mg) with family name ubuntu-web-server
